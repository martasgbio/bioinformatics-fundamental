library(tidyr)
# Para transformar a long se puede usar la función gather, indicando los nombres de las columnas que quieres obtener y exceptuando el resto de columnas.
# Después como se ha sugerido se separa una de las columnas con la función separate, indicando el nombre de la columna que se quiere modificar y el nombre de las dos columna nuevas. Con sep le estamos indicando de qué forma tiene que separarlo, por un lado las letras en la primera columna y por el oro lado los numeros en la siguiente columna.
ArchivoR_long = ActividadR %>% gather(Nutriente.tasa, Expresión_genética, - name, -BP, -MF, -systematic_name)
# Lista de paquetes a instalar
list.of.packages = c("R.utils","seqinr","tibble","stringr","tidyr","readxl","ggplot2","ape")
list.of.packages
list.of.packages_Bio = c("GEOquery")
list.of.packages_Bio
# Verificar paquetes no instalados y si hay paquetes que faltan los instala
new.packages = list.of.packages[!(list.of.packages %in% installed.packages())]
if(length(new.packages)> 0) install.packages(new.packages)
new.packages = list.of.packages_Bio[!(list.of.packages_Bio %in% installed.packages())]
if(length(new.packages)> 0) BiocManager::install(new.packages,version = BiocManager::version())
# uso de lapply para cargar todos los paquetes en memoria
invisible(lapply(list.of.packages, FUN=library, character.only=TRUE))
invisible(lapply(list.of.packages_Bio, FUN=library, character.only=TRUE))
rm(list.of.packages, new.packages)
library(ape)
# as.character = FALSE, da un tipo de objeto de la clase "DNAbin", secuencias de ADN en formato binario que son más compactos
# as.character = TRUE, da una lista de cadenas de caracteres
# El DNAbin es más rápido de manejar, para trabajar con grandes conjuntos de secuencias. Pero en este caso trabajaría con as.character TRUE, ya que deja hacer manipulaciones simples en la cadena de ADN
access.nb = "NC_001475"
secuencia = read.GenBank(access.nb, seq.names = access.nb, species.names = TRUE,
as.character = FALSE, chunk.size = 400, quiet = TRUE, type = "DNA")
secuencia2 = read.GenBank(access.nb, seq.names = access.nb, species.names = TRUE,
as.character = TRUE, chunk.size = 400, quiet = TRUE, type = "DNA")
class(secuencia2)
print(secuencia2)
length(secuencia2)
length(secuencia2[[1]])
# Devuelve una lista
# Tiene una sola secuencia
# La longitud de la secuencia es de 10707
# almacenamiento de la secuencia en formato FASTA
write.fasta(names="DEN-3.FASTA", sequences=secuencia2, file.out="DEN-3.FASTA")
# comprobación de que el nuevo archivo FASTA se puede leer
secdengue = read.fasta(file="DEN-3.FASTA")
class(secdengue)
length(secdengue)
length(secdengue[[1]])
datos_orchid = read.fasta(file="ls_orchid.fasta")
datos_orchid = read.fasta(file="ls_orchid.fasta")
print(paste("El número de secuencias es ", length(datos_orchid)))
# se han descargado 94 secuencias
longitud_secuencias = sapply(datos_orchid, FUN=length)
View(longitud_secuencias)
head((longitud_secuencias),5)
Nucleotidos=sapply(datos_orchid, FUN=count,1)
View(Nucleotidos)
Nucleotidos[1:3,1:10]
Nucleotidos = t(Nucleotidos)
Nucleotidos = as.data.frame(Nucleotidos)
Nucleotidos = Nucleotidos %>% tibble::rownames_to_column( "Identificador_Secuencias")
ActividadR = read.csv(file="ActividadR.csv")
View(ActividadR)
str(ActividadR)
class(ActividadR)
print(ActividadR)
library(tidyr)
# Para transformar a long se puede usar la función gather, indicando los nombres de las columnas que quieres obtener y exceptuando el resto de columnas.
# Después como se ha sugerido se separa una de las columnas con la función separate, indicando el nombre de la columna que se quiere modificar y el nombre de las dos columna nuevas. Con sep le estamos indicando de qué forma tiene que separarlo, por un lado las letras en la primera columna y por el oro lado los numeros en la siguiente columna.
ArchivoR_long = ActividadR %>% gather(Nutriente.tasa, Expresión_genética, - name, -BP, -MF, -systematic_name)
ArchivoR_long = ArchivoR_long %>% separate(col = "Nutriente.tasa",
into = c("Nutriente", "Tasa_crecimiento"),
sep = "(?<=[A-Za-z])[0-9]",
remove = TRUE,
convert = TRUE,
)
View(ArchivoR_long)
library(ggplot2)
library(dplyr)
# En estre caso he creado un nuevo data frame seleccionando solo los datos que corresponden al gen LEU4
LEU4 = ArchivoR_long %>% filter(name == "LEU4")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen LEU4")
# o también se puede hacer directamente mediante otro pipe
ArchivoR_long %>% filter(name == "LEU4") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen LEU4")
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_point(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + geom_smooth(method = "lm", se = FALSE, linetype = "solid", size= 1) + facet_wrap(~name)
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen LEU4") + facet_wrap(~BP)
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen LEU4")
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen")
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen")
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen")
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") +
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~BP)
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~BP)
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen")
View(LEU)
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~BP)
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~BP)
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~BP)
LEU = ArchivoR_long %>% filter(BP == "leucine biosynthesis")
ggplot(data=LEU4, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") +facet_wrap(~BP)
ArchivoR_long %>% filter(BP == "leucine biosynthesis") %>% ggplot(, mapping= aes(x=Tasa_crecimiento, y = Expresión_genética, color=Nutriente)) +
geom_line(size=1) + labs (x="Tasa de crecimiento", y="Expresión del gen") + facet_wrap(~name)
library(rmarkdown)
library(knitr)
render("R-Actividad-1_Marta_SevillanoGonzalez.Rmd")
# Lista de paquetes a instalar
list.of.packages = c("R.utils","seqinr","tibble","stringr","tidyr","readxl","ggplot2","ape")
list.of.packages
list.of.packages_Bio = c("GEOquery")
list.of.packages_Bio
# Verificar paquetes no instalados y si hay paquetes que faltan los instala
new.packages = list.of.packages[!(list.of.packages %in% installed.packages())]
if(length(new.packages)> 0) install.packages(new.packages)
new.packages = list.of.packages_Bio[!(list.of.packages_Bio %in% installed.packages())]
if(length(new.packages)> 0) BiocManager::install(new.packages,version = BiocManager::version())
# uso de lapply para cargar todos los paquetes en memoria
invisible(lapply(list.of.packages, FUN=library, character.only=TRUE))
invisible(lapply(list.of.packages_Bio, FUN=library, character.only=TRUE))
rm(list.of.packages, new.packages)
View(LEU)
View(secdengue)
View(ArchivoR_long)
