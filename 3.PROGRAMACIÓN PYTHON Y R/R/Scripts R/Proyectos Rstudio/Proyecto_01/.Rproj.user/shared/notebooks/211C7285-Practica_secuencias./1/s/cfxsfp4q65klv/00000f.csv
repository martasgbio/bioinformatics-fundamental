"0","getncbiseq <- function(accession)"
"0","{"
"0","  require(""seqinr"") # this function requires the SeqinR R package"
"0","  # first find which ACNUC database the accession is stored in:"
"0","  dbs <- c(""genbank"",""refseq"",""refseqViruses"",""nucleotide"",""bacterial"")"
"0","  numdbs <- length(dbs)"
"0","  for (i in 1:numdbs)"
"0","  {"
"0","    db <- dbs[i]"
"0","    choosebank(db)"
"0","    # check if the sequence is in ACNUC database 'db':"
"0","    resquery <- try(query("".tmpquery"", paste(""AC="", accession)), silent = TRUE)"
"0","    if (!(inherits(resquery, ""try-error"")))"
"0","    {"
"0","      queryname <- ""query2"""
"0","      thequery <- paste(""AC="", accession, sep="""")"
"0","      query2 <- query(queryname, thequery)"
"0","      # see if a sequence was retrieved:"
"0","      seq <- getSequence(query2$req[[1]])"
"0","      closebank()"
"0","      return(seq)"
"0","    }"
"0","    closebank()"
"0","  }"
"0","  print(paste(""ERROR: accession"",accession,""was not found""))"
"0","}"
